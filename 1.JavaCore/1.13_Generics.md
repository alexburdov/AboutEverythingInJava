### 1.13 Generics

В Java дженерики (generics) - это механизм, который позволяет создавать классы, интерфейсы и методы, работающие с различными типами данных, при этом сохраняя безопасность типов во время компиляции. Другими словами, это способ создания обобщенного кода, который может быть использован с разными типами данных, не прибегая к приведению типов во время выполнения и не теряя информацию о типе.

#### Ковариантность, контравариантность и инвариантность

Ковариантность - это свойство типов, при котором порядок наследования сохраняется при переносе на производные типы.

Контравариантностью называется обращение иерархии исходных типов на противоположную в производных типах.

Инвариантность, в общем смысле, означает сохранение какого-либо свойства или характеристики при определенных преобразованиях или изменениях условий.

- Массивы в Java ковариантны. Тип S[] является подтипом T[], если S — подтип T.

- «Дженерики» инвариантны. То есть List\<Integer\> является только списком Integer. Для расширение вверх или низ нужно использовать WildCard "? extends ..." или "? super ..."

#### Стирание типов

Стирание типов (Type Erasure) в Java - это механизм, при котором информация о типах обобщений (generics) удаляется на этапе компиляции. В результате, обобщенные типы существуют только во время компиляции и не видны в байт-коде, вместо них используются "сырые" типы (raw types). Это сделано для обеспечения обратной совместимости с более старыми версиями Java, где обобщения еще не существовали.

В целом, стирание типов - это компромисс между типовой безопасностью и совместимостью, который позволяет использовать обобщения в Java без кардинальных изменений в работе виртуальной машины.

- **Обобщения (Generics):**
  В Java обобщения позволяют создавать классы, интерфейсы и методы, работающие с разными типами данных, при этом обеспечивая проверку типов на этапе компиляции.
- **Стирание типов:**
  На этапе компиляции компилятор заменяет все параметры типов в обобщенных типах на их границы (если есть) или на Object, если границы не указаны.
- **Пример:**
  Если у вас есть класс List<String>, то после стирания типов в байт-коде он будет представлен как List, то есть, как обычный список, без указания типа хранимых элементов.
- **Зачем нужно:**
  Стирание типов позволяет использовать обобщения в Java без необходимости перекомпилировать старый код, написанный до появления этой функциональности.
- **Последствия:**
  Из-за стирания типов, на этапе выполнения программы невозможно определить, какой именно тип был использован в обобщенном типе. Это может приводить к определенным ограничениям и особенностям при работе с обобщениями.
- **Ограничения:**

  - Нельзя создавать экземпляры параметризованных типов.
  - Нельзя использовать оператор instanceof с параметризованными типами
  - Нельзя использовать примитивные типы в качестве параметров обобщений
  - Нельзя использовать обобщенные типы в статических полях или методах
  - Нельзя использовать обобщенные типы в исключениях.
- **Bridge-методы:**
  Компилятор также генерирует так называемые bridge-методы для обеспечения корректной работы с обобщениями при наследовании.
