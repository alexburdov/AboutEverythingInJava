### Основные концепции Docker

![img.png](img/docker_00.png)

#### Практики Docker
- _**Игнорирование файлов при сборке.**_ Когда вы запускаете сборку образа, Docker-клиент ищет в корне контекста файл .dockerignore. Если он найден, все файлы и каталоги, подпадающие под его шаблоны, исключаются из контекста ещё до того, как будут переданы билдеру.

- _**Многоступенчатая сборка (multi-stage builds)**_ Multi-stage позволяет в одном Dockerfile отделить стадию сборки (с компиляторами, dev-зависимостями) от стадии рантайма. В результате финальный образ содержит только необходимые двоичные файлы и библиотеки — меньше места и быстрее старт.
```yaml
FROM golang:1.24 AS build
WORKDIR /app
COPY go.mod go.sum ./
RUN go mod download
COPY . .
RUN CGO_ENABLED=0 go build -o /app/bin/app ./cmd/app

FROM alpine:3.20
RUN adduser -D appuser
COPY --from=build /app/bin/app /usr/local/bin/app
USER appuser
CMD ["/usr/local/bin/app"]
```
AS build даёт именованный этап, откуда потом COPY --from=build берёт файлы.

- _**Типы Mounts**_ BuildKit позволяет в инструкциях RUN использовать дополнительные монтирования (mounts), чтобы облегчить сборку образов. Типы монтирования:
    - **bind** погрузить директорию или файл из файловой системы хоста в контейнер, для использования в RUN.
    - **cache** кэшировать директории между сборками, ускорить установку зависимостей, компиляцию и др.
    - **ssh** давать доступ к SSH-агенту или ключам для клонирования приватных репозиториев или других SSH-операций.
    - **secret** безопасно передавать секреты (API-ключи, пароли и др.), не включать их в итоговый образ.

- **Здоровье контейнеров: HEALTHCHECK** Иногда сервис формально запущен, но внутри него процесс повис или работает некорректно. Docker позволяет описать внутри образа команду для проверки состояния контейнера.

- **Log drivers: управление логами** По умолчанию Docker сохраняет логи в JSON-файл. Но это далеко не всегда удобно. Для интеграции с системами мониторинга можно выбрать другие драйверы

- **Docker login** 